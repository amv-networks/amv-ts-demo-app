<div class="container mat-typography">

  <button mat-button class="m-1" [disabled]="!hasUserValue" style="float: right" (click)="onDeleteStoredSettingsClicked(); settingsForm.reset();">
    <mat-icon>delete_all</mat-icon> Delete stored settings
  </button>

  <h1>Settings</h1>

  <form #settingsForm="ngForm" class="form-container" [formGroup]="options">
    <div class="mat-elevation-z5">
      <mat-tab-group>
        <mat-tab label="API">
          <div class="m-1">
            
            <div fxLayout="row wrap" fxLayoutAlign="space-around center">
              <mat-form-field class="full-width mb-1">
                <mat-label>Base URL</mat-label>
                <mat-hint>The backend service you want to communicate with</mat-hint>
                <input matInput type="text" placeholder="https://www.example.com/api/v1" formControlName="baseUrl" minlength="10">
                <mat-error *ngIf="options.get('baseUrl')?.invalid">Invalid</mat-error>
              </mat-form-field>
            </div>

            <div fxLayout="row" fxLayout.xs="column">
              <div fxFlex>
                <mat-form-field class="full-width">
                  <mat-label>Username</mat-label>
                  <mat-hint>The username you want to authenticate with</mat-hint>
                  <input matInput type="text" placeholder="john_doe" formControlName="username" minlength="1">
                  <mat-error *ngIf="options.get('username')?.invalid">Invalid</mat-error>
                </mat-form-field>
              </div>
              <div fxFlex="1"></div>
              <div fxFlex>
                <mat-form-field class="full-width ">
                  <mat-label>Password</mat-label>
                  <input matInput type="password" formControlName="password" minlength="1">
                  <mat-error *ngIf="options.get('password')?.invalid">Invalid</mat-error>
                </mat-form-field>
              </div>
            </div>

            <mat-form-field class="full-width mb-1">
              <mat-label>Contract ID</mat-label>
              <mat-hint>Id of the contract you want to be used for requests</mat-hint>
              <input matInput type="number" formControlName="contractId" min="1">
              <mat-error *ngIf="options.get('contractId')?.invalid">Invalid</mat-error>
            </mat-form-field>
          </div>
        </mat-tab>
        <mat-tab label="Application">
          <div class="m-1">
            <div class="mt-1 mb-1">
              <mat-checkbox class="ml-1" formControlName="debugMode">Debug Mode</mat-checkbox>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>

      <div class="m-1">
        <div class="mr-1" style="display: inline-block;">
          <button mat-raised-button color="primary" [disabled]="options.invalid" (click)="onFormSubmit()">
            <mat-icon>save_alt</mat-icon> {{ hasUserKey ? 'Save' : 'Enter passphrase and save' }}
          </button>
        </div>
        <button mat-raised-button color="primary" [hidden]="!hasUserKey" [disabled]="options.invalid" (click)="onFormSubmitWithNewPassphrase()">
          <mat-icon>lock</mat-icon> Save with new passphrase
        </button>
      </div>
    </div>
  </form>

</div>